#!/usr/bin/awk -f
#------------------------------------------------------------------------------#
#                            Programmed By Liz                                 #
#------------------------------------------------------------------------------#
# fat cat summary
#===============================================================================
BEGIN {
   y=8                                    # column widths
   x=w-7
}
#===============================================================================
{
#--------------------------------------------------------------------- save data
   for(i=1;i<=NF;i++)
   {
      l=length($i)
      n[i]=substr($i,1,l-1)         # get number part
      u[i]=substr($i,l)             # get unit
      a[i]=n[i]                     # used, avail, size -> G
      switch(u[i])
      {
         case "K" :
            a[i]=a[i]/1000
         case "M" :
            a[i]=a[i]/1000
      }
   }
#---------------------------------------------------------------------- bargraph
   p=a[1]/a[3]                    # raw percent use
   q=int(p*x+0.5)                 # bar length
   b="█"                          # ░ ▒ ▓ █
   if(p<=0.17)
   {
      s="\033[0;35m"              # magenta
      b="▓"
   }
   else if(p<=0.33)
   {
      s="\033[0;34m"                # blue
      b="▓"
   }
   else if(p<=0.50)
   {
      s="\033[0;36m"                # cyan
      b="▒"
   }
   else if(p<=0.67)
   {
      s="\033[0;32m"                # green
      b="▓"
   }
   else if(p<=0.83)
   {
      s="\033[0;33m"                # yellow
      b="▓"
   }
   else
      s="\033[0;31m"                # red
   for(i=0;i<q;i++)                 # left bar
      s=s b
   # s=s"\033[1;30m"                # won't work with Terminator
   s=s"\033[2;37m"
   for(i=0;i<(x-q);i++)             # right bar
      s=s"░"                        # ‧
   s=s"\033[0m"
#------------------------------------------------------------------------- print
   for(i=1;i<=NF;i++)               # print formatted number strings
   {
      o=sprintf("%6.1f%s",n[i],u[i])
      printf("%"y"s",o)
   }
   printf("\n")
   printf("%5.1f%% %s\n",p*100,s)   # print bargraph
}
#===============================================================================
END {
}
#===============================================================================
# functions
#===============================================================================
